<!DOCTYPE html>
<html  lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1"><meta name="viewport" content="width=device-width, initial-scale=1" />

      <title>CoupledCluster</title>
    
          <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
          <link rel="stylesheet" href="../_static/theme.css " type="text/css" />
      
      <!-- sphinx script_files -->
        <script src="../_static/documentation_options.js?v=5929fcd5"></script>
        <script src="../_static/doctools.js?v=888ff710"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

      
      <!-- bundled in js (rollup iife) -->
      <!-- <script src="../_static/theme-vendors.js"></script> -->
      <script src="../_static/theme.js" defer></script>
    
  <link rel="index" title="Index" href="../genindex.html" />
  <link rel="search" title="Search" href="../search.html" />
  <link rel="next" title="DefineHolesAndParticles" href="DefineHolesAndParticles.html" />
  <link rel="prev" title="BasisSetCorrection" href="BasisSetCorrection.html" /> 
  </head>

  <body>
    <div id="app">
    <div class="theme-container" :class="pageClasses"><navbar @toggle-sidebar="toggleSidebar">
  <router-link to="../index.html" class="home-link">
    
      <span class="site-name">CC4S</span>
    
  </router-link>

  <div class="links">
    <navlinks class="can-hide">



    </navlinks>
  </div>
</navbar>

      
      <div class="sidebar-mask" @click="toggleSidebar(false)">
      </div>
        <sidebar @toggle-sidebar="toggleSidebar">
          
          <navlinks>
            



            
          </navlinks><div id="searchbox" class="searchbox" role="search">
  <div class="caption"><span class="caption-text">Quick search</span>
    <div class="searchformwrapper">
      <form class="search" action="../search.html" method="get">
        <input type="text" name="q" />
        <input type="submit" value="Search" />
        <input type="hidden" name="check_keywords" value="yes" />
        <input type="hidden" name="area" value="default" />
      </form>
    </div>
  </div>
</div><div class="sidebar-links" role="navigation" aria-label="main navigation">
  
    <div class="sidebar-group">
      <p class="caption">
        <span class="caption-text"><a href="../index.html#cc4s-user-documentation">cc4s user documentation</a></span>
      </p>
      <ul class="">
        
          <li class="toctree-l1 ">
            
              <a href="../gettingstarted/gettingstarted.html" class="reference internal ">Getting Started</a>
            

            
          </li>

        
          <li class="toctree-l1 ">
            
              <a href="index.html" class="reference internal ">Algorithms</a>
            

            
          </li>

        
          <li class="toctree-l1 ">
            
              <a href="../objects/index.html" class="reference internal ">Objects</a>
            

            
          </li>

        
          <li class="toctree-l1 ">
            
              <a href="../interfaces/vasp.html" class="reference internal ">Description of VASP interface to Cc4s</a>
            

            
          </li>

        
          <li class="toctree-l1 ">
            
              <a href="../tutorials/Rbn_tutorial.html" class="reference internal ">How to run Cc4s calculations?</a>
            

            
          </li>

        
          <li class="toctree-l1 ">
            
              <a href="../what/what.html" class="reference internal ">About the code</a>
            

            
          </li>

        
          <li class="toctree-l1 ">
            
              <a href="../performance/performance.html" class="reference internal ">Performance and compute resources</a>
            

            
          </li>

        
          <li class="toctree-l1 ">
            
              <a href="../contact/contact.html" class="reference internal ">Contact</a>
            

            
          </li>

        
          <li class="toctree-l1 ">
            
              <a href="../how-to-write.html" class="reference internal ">How To Write</a>
            

            
          </li>

        
      </ul>
    </div>
  
</div>
        </sidebar>

      <page>
          <div class="body-header" role="navigation" aria-label="navigation">
  
  <ul class="breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
    
      <li><a href="index.html">Algorithms</a> &raquo;</li>
    
    <li>CoupledCluster</li>
  </ul>
  

  <ul class="page-nav">
  <li class="prev">
    <a href="BasisSetCorrection.html"
       title="previous chapter">← BasisSetCorrection</a>
  </li>
  <li class="next">
    <a href="DefineHolesAndParticles.html"
       title="next chapter">DefineHolesAndParticles →</a>
  </li>
</ul>
  
</div>
<hr>
          <div class="content" role="main" v-pre>
            
  <section id="coupledcluster">
<h1><a class="toc-backref" href="#id13" role="doc-backlink">CoupledCluster</a><a class="headerlink" href="#coupledcluster" title="Link to this heading">¶</a></h1>
<nav class="contents" id="contents">
<p class="topic-title">Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#coupledcluster" id="id13">CoupledCluster</a></p>
<ul>
<li><p><a class="reference internal" href="#brief-description" id="id14">1 Brief description</a></p></li>
<li><p><a class="reference internal" href="#algorithm-call" id="id15">2 Algorithm call</a></p></li>
<li><p><a class="reference internal" href="#algorithm-input" id="id16">3 Algorithm input</a></p>
<ul>
<li><p><a class="reference internal" href="#method" id="id17">3.1 method</a></p></li>
<li><p><a class="reference internal" href="#linearzied" id="id18">3.2 linearzied</a></p></li>
<li><p><a class="reference internal" href="#integralsslicesize" id="id19">3.3 integralsSliceSize</a></p></li>
<li><p><a class="reference internal" href="#maxiterations" id="id20">3.4 maxIterations</a></p></li>
<li><p><a class="reference internal" href="#energyconvergence" id="id21">3.5 energyConvergence</a></p></li>
<li><p><a class="reference internal" href="#amplitudesconvergence" id="id22">3.6 amplitudesConvergence</a></p></li>
<li><p><a class="reference internal" href="#initialamplitudes" id="id23">3.7 initialAmplitudes</a></p></li>
<li><p><a class="reference internal" href="#mixer" id="id24">3.8 mixer</a></p>
<ul>
<li><p><a class="reference internal" href="#diismixer" id="id25">3.8.1 DiisMixer</a></p></li>
<li><p><a class="reference internal" href="#linearmixer" id="id26">3.8.2 LinearMixer</a></p></li>
</ul>
</li>
</ul>
</li>
<li><p><a class="reference internal" href="#algorithm-output" id="id27">4 Algorithm output</a></p>
<ul>
<li><p><a class="reference internal" href="#sample-stdout" id="id28">4.1 Sample <code class="docutils literal notranslate"><span class="pre">stdout</span></code></a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#sample-yaml-output" id="id29">5 Sample <code class="docutils literal notranslate"><span class="pre">yaml</span></code> output</a></p></li>
<li><p><a class="reference internal" href="#computational-complexity" id="id30">6 Computational complexity</a></p></li>
<li><p><a class="reference internal" href="#theory" id="id31">7 Theory</a></p>
<ul>
<li><p><a class="reference internal" href="#coupled-cluster-singles-doubles-ccsd" id="id32">7.1 Coupled-Cluster Singles Doubles (<code class="docutils literal notranslate"><span class="pre">Ccsd</span></code>)</a></p></li>
<li><p><a class="reference internal" href="#direct-ring-couple-cluster-doubles-drccd" id="id33">7.2 Direct-Ring Couple-Cluster Doubles (<code class="docutils literal notranslate"><span class="pre">Drccd</span></code>)</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#literature" id="id34">8 Literature</a></p></li>
</ul>
</li>
</ul>
</nav>
<section id="brief-description">
<h2><a class="toc-backref" href="#id14" role="doc-backlink">1 Brief description</a><a class="headerlink" href="#brief-description" title="Link to this heading">¶</a></h2>
<p>This algorithm solves the CCSD amplitude equations using the Coulomb integrals
and Hartree–Fock eigenenergies.</p>
</section>
<section id="algorithm-call">
<h2><a class="toc-backref" href="#id15" role="doc-backlink">2 Algorithm call</a><a class="headerlink" href="#algorithm-call" title="Link to this heading">¶</a></h2>
<p>A typical input file snippet to call the <code class="docutils literal notranslate"><span class="pre">CoupledCluster</span></code> algorithm is given below.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">CoupledCluster</span>
<span class="w">  </span><span class="nt">in</span><span class="p">:</span>
<span class="w">    </span><span class="nt">method</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Ccsd</span>
<span class="w">    </span><span class="nt">integralsSliceSize</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">100</span>
<span class="w">    </span><span class="nt">slicedEigenEnergies</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">EigenEnergies</span>
<span class="w">    </span><span class="nt">coulombIntegrals</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">CoulombIntegrals</span>
<span class="w">    </span><span class="nt">slicedCoulombVertex</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">CoulombVertex</span>
<span class="w">    </span><span class="nt">maxIterations</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">20</span>
<span class="w">    </span><span class="nt">energyConvergence</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1.0E-4</span>
<span class="w">    </span><span class="nt">amplitudesConvergence</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1.0E-4</span>
<span class="w">    </span><span class="nt">mixer</span><span class="p">:</span>
<span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">DiisMixer</span>
<span class="w">      </span><span class="nt">maxResidua</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5</span>
<span class="w">    </span><span class="c1">#or for instance a linear mixer</span>
<span class="w">    </span><span class="c1">#mixer:</span>
<span class="w">    </span><span class="c1">#  type: LinearMixer</span>
<span class="w">    </span><span class="c1">#  ratio: 1.0</span>
<span class="w">  </span><span class="nt">out</span><span class="p">:</span>
<span class="w">    </span><span class="nt">amplitudes</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Amplitudes</span>
</pre></div>
</div>
</section>
<section id="algorithm-input">
<h2><a class="toc-backref" href="#id16" role="doc-backlink">3 Algorithm input</a><a class="headerlink" href="#algorithm-input" title="Link to this heading">¶</a></h2>
<section id="method">
<span id="id1"></span><h3><a class="toc-backref" href="#id17" role="doc-backlink">3.1 method</a><a class="headerlink" href="#method" title="Link to this heading">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">method</span></code> specifies which approximation of the coupled-cluster
<a class="reference external" href="../objects/Amplitudes.html">Amplitudes</a> should be used. See the
<a class="reference external" href="../objects/Amplitudes.html">Amplitudes</a> for the specification of
each approximation.
The currently available approximations are:</p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">Ccsd</span></code></dt><dd><p>Coupled Cluster singles and doubles. See (Bartlett, R.J. and Musiał, Monika, 2007) and references therin.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">CcsdReference</span></code></dt><dd><p>Canonical and unoptimized version of the <code class="docutils literal notranslate"><span class="pre">Ccsd</span></code> algorithm.
This algorithm has the same inputs as <code class="docutils literal notranslate"><span class="pre">Ccsd</span></code> with the exception that the
arguments
<a class="reference internal" href="#integralsslicesize">integralsslicesize</a> and
<a class="reference external" href="../objects/SlicedCoulombVertex.html">slicedCoulombVertex</a> and
are ignored.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">Drccd</span></code></dt><dd><p>Unoptimized implementation of Direct-Ring Coupled Cluster
singles and doubles giving the Random Phase Approximation (RPA)
with the Second Order Screened Exchange (SOSEX) correction
(Freeman, David, 1977, Grüneis, Andreas and Marsman, Martijn and Harl, Judith and Schimka, Laurids and Kresse, Georg, 2009).</p>
</dd>
</dl>
</section>
<section id="linearzied">
<span id="linearized"></span><h3><a class="toc-backref" href="#id18" role="doc-backlink">3.2 linearzied</a><a class="headerlink" href="#linearzied" title="Link to this heading">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">linearized</span></code> A non-zero value indicates that the linearized
coupled-cluster amplitude equations should be solved, rather
than the fully non-linear ones.
The default is <code class="docutils literal notranslate"><span class="pre">linearized:</span> <span class="pre">0</span></code>.
Note: currently only <code class="docutils literal notranslate"><span class="pre">method:</span> <span class="pre">Drccd</span></code> supports linearized
amplitude equations.</p>
</section>
<section id="integralsslicesize">
<span id="id3"></span><h3><a class="toc-backref" href="#id19" role="doc-backlink">3.3 integralsSliceSize</a><a class="headerlink" href="#integralsslicesize" title="Link to this heading">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">integralsSliceSize</span></code> controls the slice size of the <span class="math notranslate nohighlight">\(V_{cd}^{ab}\)</span> integrals, which are computed on-the-fly to
reduce the memory footprint. The integer value specified for <code class="docutils literal notranslate"><span class="pre">integralsSliceSize</span></code>  refers to the dimension size
used for the <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(b\)</span> index. We recommend setting <code class="docutils literal notranslate"><span class="pre">integralsSliceSize:</span> <span class="pre">100</span></code> to balance
computational efficency with memory usage. Smaller/larger values reduce/increase the memory footprint.</p>
</section>
<section id="maxiterations">
<span id="id4"></span><h3><a class="toc-backref" href="#id20" role="doc-backlink">3.4 maxIterations</a><a class="headerlink" href="#maxiterations" title="Link to this heading">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">maxIterations</span></code> controls the maximum number of iterations allowed to solve the  <span class="math notranslate nohighlight">\(t_{ij}^{ab}\)</span> and <span class="math notranslate nohighlight">\(t_i^a\)</span> amplitude equations.
If convergence of the energy and residual vectors within the specified thresholds is achieved using fewer iterations
than <code class="docutils literal notranslate"><span class="pre">maxIterations</span></code>, the algorithm was successfull and will stop.
If <code class="docutils literal notranslate"><span class="pre">maxIterations</span></code> is reached without achieving <code class="docutils literal notranslate"><span class="pre">energyConvergence</span></code> and <code class="docutils literal notranslate"><span class="pre">amplitudesConvergence</span></code> , the algorithm was not
successful and will stop. We recommend to set <code class="docutils literal notranslate"><span class="pre">maxIterations:</span> <span class="pre">20</span></code>, which is ususally enough to achieve reasonable convergence
thresholds.</p>
</section>
<section id="energyconvergence">
<span id="id5"></span><h3><a class="toc-backref" href="#id21" role="doc-backlink">3.5 energyConvergence</a><a class="headerlink" href="#energyconvergence" title="Link to this heading">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">energyConvergence</span></code> specifies the convergence threshold for the correlation energy.
If <code class="docutils literal notranslate"><span class="pre">energyConvergence</span></code> and <code class="docutils literal notranslate"><span class="pre">amplitudesConvergence</span></code> is achieved, the iterative solution was successful and the algorithm will stop.</p>
</section>
<section id="amplitudesconvergence">
<span id="id6"></span><h3><a class="toc-backref" href="#id22" role="doc-backlink">3.6 amplitudesConvergence</a><a class="headerlink" href="#amplitudesconvergence" title="Link to this heading">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">amplitudesConvergence</span></code> specifies the convergence threshold for the residual vector of the singles and doubles amplitude equations.
If <code class="docutils literal notranslate"><span class="pre">energyConvergence</span></code> and <code class="docutils literal notranslate"><span class="pre">amplitudesConvergence</span></code> is achieved, the iterative solution was successful and the algorithm will stop.</p>
</section>
<section id="initialamplitudes">
<span id="initialamplitude"></span><h3><a class="toc-backref" href="#id23" role="doc-backlink">3.7 initialAmplitudes</a><a class="headerlink" href="#initialamplitudes" title="Link to this heading">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">initialAmplitudes</span></code> specifies amplitudes from a precedent calculations. This allows restarting a self consistent calculation from a former checkpoint.</p>
</section>
<section id="mixer">
<span id="id7"></span><h3><a class="toc-backref" href="#id24" role="doc-backlink">3.8 mixer</a><a class="headerlink" href="#mixer" title="Link to this heading">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">mixer</span></code> specifies mixer-specific parameters used to solve the amplitude equations iteratively.
The direct inversion iterative subspace (Diis) algorithm is the default algorithm used to mix amplitude guesses from previous
iterations to improve the guess for the next iteration.
<code class="docutils literal notranslate"><span class="pre">mixer:</span> <span class="pre">type</span></code> can currently be set to <code class="docutils literal notranslate"><span class="pre">\*DiisMixer</span></code> or <code class="docutils literal notranslate"><span class="pre">\*LinearMixer</span></code>.</p>
<section id="diismixer">
<h4><a class="toc-backref" href="#id25" role="doc-backlink">3.8.1 DiisMixer</a><a class="headerlink" href="#diismixer" title="Link to this heading">¶</a></h4>
<p>For <code class="docutils literal notranslate"><span class="pre">mixer:</span> <span class="pre">type:</span> <span class="pre">DissMixer</span></code>, it is possible to specify <code class="docutils literal notranslate"><span class="pre">mixer:</span> <span class="pre">maxResidua</span></code>, which controls the number of residual
vectors used by the Diis mixer.
We recommend to set the maximum number of residual vectors used in the <code class="docutils literal notranslate"><span class="pre">DiisMixer</span></code> to <code class="docutils literal notranslate"><span class="pre">5</span></code>.
More residual vectors result in a larger memory footprint.</p>
<p>Example</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">mixer</span><span class="p">:</span>
<span class="w">  </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">DiisMixer</span>
<span class="w">  </span><span class="nt">maxResidua</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5</span>
</pre></div>
</div>
</section>
<section id="linearmixer">
<h4><a class="toc-backref" href="#id26" role="doc-backlink">3.8.2 LinearMixer</a><a class="headerlink" href="#linearmixer" title="Link to this heading">¶</a></h4>
<p>For <code class="docutils literal notranslate"><span class="pre">mixer:</span> <span class="pre">type:</span> <span class="pre">LinearMixer</span></code> it is possible to specify <code class="docutils literal notranslate"><span class="pre">mixer:</span> <span class="pre">ratio</span></code>, which controls the mixing ratio used
to update the new guess of the amplitudes based on estimates from the previous and current iteration.
The <code class="docutils literal notranslate"><span class="pre">LinearMixer</span></code> exhibits the smallest possible memory footprint from all currently available mixers,
keeping two sets of amplitudes in memory at once only.
We recommend to set <code class="docutils literal notranslate"><span class="pre">mixer:</span> <span class="pre">ratio:</span> <span class="pre">1.0</span></code>. Smaller ratios result in a slower but perhaps more stable convergence.</p>
<p>Example</p>
<div class="highlight-yaml notranslate" id="linear-mixer-example"><div class="highlight"><pre><span></span><span class="nt">mixer</span><span class="p">:</span>
<span class="w">  </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">LinearMixer</span>
<span class="w">  </span><span class="nt">ratio</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1.0</span>
</pre></div>
</div>
</section>
</section>
</section>
<section id="algorithm-output">
<h2><a class="toc-backref" href="#id27" role="doc-backlink">4 Algorithm output</a><a class="headerlink" href="#algorithm-output" title="Link to this heading">¶</a></h2>
<p>The output of the <strong>CoupledCluster</strong> algorithm includes <code class="docutils literal notranslate"><span class="pre">energy</span></code> and <code class="docutils literal notranslate"><span class="pre">amplitudes</span></code> . The <code class="docutils literal notranslate"><span class="pre">amplitudes</span></code> output contains
the converged singles and doubles amplitude tensors. The amplitudes can be used as input for algorithms
that estimate the finite simulation cell size error (<strong>FiniteSizeCorrection</strong>)
and the basis set incompleteness errors (<strong>BasisSetCorrection</strong>).</p>
<section id="sample-stdout">
<h3><a class="toc-backref" href="#id28" role="doc-backlink">4.1 Sample <code class="docutils literal notranslate"><span class="pre">stdout</span></code></a><a class="headerlink" href="#sample-stdout" title="Link to this heading">¶</a></h3>
<p>Below an example standard output stream is shown for a successful <strong>CoupledCluster</strong> algorithm run.</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>step:<span class="w"> </span><span class="m">6</span>,<span class="w"> </span>CoupledCluster
Using<span class="w"> </span>method<span class="w"> </span>Ccsd.<span class="w"> </span>integralsSliceSize:<span class="w"> </span><span class="m">100</span>
Using<span class="w"> </span>mixer<span class="w"> </span>DiisMixer.<span class="w"> </span>maxResidua:<span class="w"> </span><span class="m">5</span>
Maximum<span class="w"> </span>number<span class="w"> </span>of<span class="w"> </span>iterations:<span class="w"> </span><span class="m">30</span>
Unless<span class="w"> </span>reaching<span class="w"> </span>energy<span class="w"> </span>convergence<span class="w"> </span>dE:<span class="w"> </span>1e-05
and<span class="w"> </span>amplitudes<span class="w"> </span>convergence<span class="w"> </span>dR:<span class="w"> </span>1e-05
Iter<span class="w">         </span>Energy<span class="w">         </span>dE<span class="w">           </span>dR<span class="w">         </span><span class="nb">time</span><span class="w">   </span>GF/s/core
<span class="w">   </span><span class="m">1</span><span class="w">  </span>-2.43605043e+01<span class="w">  </span>-2.4361e+01<span class="w">   </span><span class="m">4</span>.3924e-01<span class="w">      </span><span class="m">0</span>.5<span class="w">    </span><span class="m">1</span>.0
<span class="w">   </span><span class="m">2</span><span class="w">  </span>-2.47577534e+01<span class="w">  </span>-3.9725e-01<span class="w">   </span><span class="m">7</span>.4733e-02<span class="w">      </span><span class="m">0</span>.8<span class="w">    </span><span class="m">4</span>.8
<span class="w">   </span><span class="m">3</span><span class="w">  </span>-2.53776918e+01<span class="w">  </span>-6.1994e-01<span class="w">   </span><span class="m">1</span>.8674e-02<span class="w">      </span><span class="m">0</span>.7<span class="w">    </span><span class="m">5</span>.4
<span class="w">   </span><span class="m">4</span><span class="w">  </span>-2.54455925e+01<span class="w">  </span>-6.7901e-02<span class="w">   </span><span class="m">6</span>.4132e-03<span class="w">      </span><span class="m">0</span>.7<span class="w">    </span><span class="m">5</span>.5
<span class="w">   </span><span class="m">5</span><span class="w">  </span>-2.54445080e+01<span class="w">   </span><span class="m">1</span>.0845e-03<span class="w">   </span><span class="m">2</span>.2120e-03<span class="w">      </span><span class="m">0</span>.7<span class="w">    </span><span class="m">5</span>.4
<span class="w">   </span><span class="m">6</span><span class="w">  </span>-2.54458312e+01<span class="w">  </span>-1.3232e-03<span class="w">   </span><span class="m">1</span>.0304e-03<span class="w">      </span><span class="m">0</span>.7<span class="w">    </span><span class="m">5</span>.4
<span class="w">   </span><span class="m">7</span><span class="w">  </span>-2.54448941e+01<span class="w">   </span><span class="m">9</span>.3705e-04<span class="w">   </span><span class="m">5</span>.0727e-04<span class="w">      </span><span class="m">0</span>.7<span class="w">    </span><span class="m">5</span>.4
<span class="w">   </span><span class="m">8</span><span class="w">  </span>-2.54452894e+01<span class="w">  </span>-3.9521e-04<span class="w">   </span><span class="m">1</span>.9694e-04<span class="w">      </span><span class="m">0</span>.7<span class="w">    </span><span class="m">5</span>.4
<span class="w">   </span><span class="m">9</span><span class="w">  </span>-2.54454262e+01<span class="w">  </span>-1.3682e-04<span class="w">   </span><span class="m">7</span>.7180e-05<span class="w">      </span><span class="m">0</span>.7<span class="w">    </span><span class="m">5</span>.4
<span class="w">  </span><span class="m">10</span><span class="w">  </span>-2.54455328e+01<span class="w">  </span>-1.0663e-04<span class="w">   </span><span class="m">3</span>.0247e-05<span class="w">      </span><span class="m">0</span>.7<span class="w">    </span><span class="m">5</span>.4
<span class="w">  </span><span class="m">11</span><span class="w">  </span>-2.54455929e+01<span class="w">  </span>-6.0110e-05<span class="w">   </span><span class="m">1</span>.1758e-05<span class="w">      </span><span class="m">0</span>.7<span class="w">    </span><span class="m">5</span>.4
<span class="w">  </span><span class="m">12</span><span class="w">  </span>-2.54456151e+01<span class="w">  </span>-2.2218e-05<span class="w">   </span><span class="m">5</span>.0053e-06<span class="w">      </span><span class="m">0</span>.7<span class="w">    </span><span class="m">5</span>.4
<span class="w">  </span><span class="m">13</span><span class="w">  </span>-2.54456249e+01<span class="w">  </span>-9.7454e-06<span class="w">   </span><span class="m">2</span>.2689e-06<span class="w">      </span><span class="m">0</span>.7<span class="w">    </span><span class="m">5</span>.4

Ccsd<span class="w"> </span>correlation<span class="w"> </span>energy:<span class="w">          </span>-25.4456248862
2nd-order<span class="w"> </span>correlation<span class="w"> </span>energy:<span class="w">     </span>-24.3605043096
realtime<span class="w"> </span><span class="m">9</span>.189542891<span class="w"> </span>s
--
</pre></div>
</div>
</section>
</section>
<section id="sample-yaml-output">
<h2><a class="toc-backref" href="#id29" role="doc-backlink">5 Sample <code class="docutils literal notranslate"><span class="pre">yaml</span></code> output</a><a class="headerlink" href="#sample-yaml-output" title="Link to this heading">¶</a></h2>
<p>Below an example <code class="docutils literal notranslate"><span class="pre">yaml</span></code> output stream is shown for a successful <strong>CoupledCluster</strong> algorithm run.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">CoupledCluster</span>
<span class="nt">out</span><span class="p">:</span>
<span class="w">  </span><span class="nt">amplitudes</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0x26e4758</span>
<span class="w">  </span><span class="nt">convergenceReached</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">  </span><span class="nt">energy</span><span class="p">:</span>
<span class="w">    </span><span class="nt">correlation</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">-25.445624886202758</span>
<span class="w">    </span><span class="nt">direct</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">-38.822491455744313</span>
<span class="w">    </span><span class="nt">exchange</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">13.376866569541555</span>
<span class="w">    </span><span class="nt">secondOrder</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">-24.360504309639897</span>
<span class="w">    </span><span class="nt">unit</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.036749322175638782</span>
<span class="nt">realtime</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">9.189542891</span>
</pre></div>
</div>
</section>
<section id="computational-complexity">
<h2><a class="toc-backref" href="#id30" role="doc-backlink">6 Computational complexity</a><a class="headerlink" href="#computational-complexity" title="Link to this heading">¶</a></h2>
<p>This section explains computational or memory footprints
for the various methods implemented in <strong>CoupledCluster</strong>
<a class="reference internal" href="#method">method</a>.</p>
<dl>
<dt><code class="docutils literal notranslate"><span class="pre">Ccsd</span></code></dt><dd><p>The computational bottle neck of a typical Ccsd calculation originates
from the following contraction, which is
part of the doubles amplitude equations: <span class="math notranslate nohighlight">\(V_{cd}^{ab} t_{ij}^{cd}\)</span>.
The computational cost for evaluating this expression scales
as <span class="math notranslate nohighlight">\(\mathcal{O}(N_{\rm o}^2 N_{\rm v}^4)\)</span>. To avoid a memory
footprint of <span class="math notranslate nohighlight">\(\mathcal{O}(N_{\rm v}^4)\)</span> in storing
<span class="math notranslate nohighlight">\(V_{cd}^{ab}\)</span>, slices <span class="math notranslate nohighlight">\(V_{cd}^{xy}\)</span> are computed on-the-fly and used
in the contraction, reducing the corresponding memory footprint to
<span class="math notranslate nohighlight">\(\mathcal{O}(N_{\rm v}^2 N_{\rm s}^2)\)</span>,
where <span class="math notranslate nohighlight">\(N_{\rm s}\)</span> is controlled using
the <code class="docutils literal notranslate"><span class="pre">integralsSliceSize</span></code> keyword.</p>
<p>We note that required storage of a set of doubles amplitudes adds
substantially to the memory footprint in Ccsd calculations.
The Diis algorithm requires the storage of both doubles residua and amplitudes
<code class="docutils literal notranslate"><span class="pre">maxResidua</span></code> times. We recommend to choose the
type of mixer and its parameters carefully to reduce the memory
footprint if necessary.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">Drccd</span></code></dt><dd><p>The computational complexity is <span class="math notranslate nohighlight">\(\mathcal O(N_\mathrm{o}^3N_\mathrm{v}^3)\)</span>.
The implementation is not optimized for large systems. The memory requirement
scales as <span class="math notranslate nohighlight">\(\mathcal O(N_\mathrm{o}^2 N_\mathrm{v}^2)\)</span></p>
</dd>
</dl>
</section>
<section id="theory">
<h2><a class="toc-backref" href="#id31" role="doc-backlink">7 Theory</a><a class="headerlink" href="#theory" title="Link to this heading">¶</a></h2>
<p>Coupled-cluster employs the exponential Ansatz for the correlated wave function</p>
<div class="math notranslate nohighlight" id="equation-algorithms-coupledcluster-0">
<span class="eqno">(1)<a class="headerlink" href="#equation-algorithms-coupledcluster-0" title="Link to this equation">¶</a></span>\[\begin{equation}
  | \Psi \rangle = e^{\hat T} | \Phi \rangle,
\end{equation}\]</div>
<p>where <span class="math notranslate nohighlight">\(|\Phi\rangle\)</span> denotes the single Hartree–Fock slater determinant.
The cluster operator <span class="math notranslate nohighlight">\(\hat T = \hat T_1 + \hat T_2 + \ldots\)</span> is
expanded in increasing number of excitation levels. The single and
double exciation parts of the cluster operator are given by</p>
<div class="math notranslate nohighlight" id="equation-algorithms-coupledcluster-1">
<span class="eqno">(2)<a class="headerlink" href="#equation-algorithms-coupledcluster-1" title="Link to this equation">¶</a></span>\[\begin{split}\begin{eqnarray}
  \hat T_1 = \sum_{ai} t^a_i \hat\tau^a_i, \\
  \hat T_2 = \sum_{abij} t^{ab}_{ij} \hat\tau^{ab}_{ij},
\end{eqnarray}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\hat \tau^{a\ldots}_{i\ldots} = \hat c^\dagger_a\ldots \hat c_i\ldots\)</span>
denotes the exciation operator.
The coefficients <span class="math notranslate nohighlight">\(t^a_i\)</span>, <span class="math notranslate nohighlight">\(t^{ab}_{ij}\)</span>, <span class="math notranslate nohighlight">\(\ldots\)</span> are called coupled-cluster
<code class="docutils literal notranslate"><span class="pre">Amplitudes</span></code>.
They are found by projecting the stationary Schrödinger equation for the
coupled-cluster Ansatz <span class="math notranslate nohighlight">\(E|\Psi\rangle = \hat H|\Psi\rangle\)</span>
on <span class="math notranslate nohighlight">\(\langle \Phi|e^{-\hat T}\)</span>.
The resulting over-determined set of equations is truncated at the
same level as the cluster-operator <span class="math notranslate nohighlight">\(\hat T\)</span>, giving as many equations
as there are coefficients in <span class="math notranslate nohighlight">\(\hat T\)</span>.
The <code class="docutils literal notranslate"><span class="pre">Amplitudes</span></code> are generated by the <a class="reference external" href="CoupledCluster.html">CoupledCluster</a>
algorithm by solving the amplitude equation of the employed
coupled-cluster method, described below:</p>
<section id="coupled-cluster-singles-doubles-ccsd">
<h3><a class="toc-backref" href="#id32" role="doc-backlink">7.1 Coupled-Cluster Singles Doubles (<code class="docutils literal notranslate"><span class="pre">Ccsd</span></code>)</a><a class="headerlink" href="#coupled-cluster-singles-doubles-ccsd" title="Link to this heading">¶</a></h3>
<p>The cluster-operator is truncated containing only single and double
excitations. The projections on the singly and doubly excited
slater-determinants <span class="math notranslate nohighlight">\(\langle \Phi^a_i|\)</span> and <span class="math notranslate nohighlight">\(\langle \Phi^{ab}_{ij}|\)</span> give</p>
<div class="math notranslate nohighlight" id="equation-algorithms-coupledcluster-2">
<span class="eqno">(3)<a class="headerlink" href="#equation-algorithms-coupledcluster-2" title="Link to this equation">¶</a></span>\[\begin{split}\begin{align}
  \big\langle \Phi^{a}_{i} \big| e^{-\hat T} \hat H e^{\hat T}
    \big| \Phi \big\rangle &amp;= 0 \quad \forall ai, \\
  \label{eqn:t2}
  \big\langle \Phi^{ab}_{ij} \big| e^{-\hat T} \hat H e^{\hat T}
    \big| \Phi \big\rangle &amp;= 0 \quad \forall abij.
\end{align}\end{split}\]</div>
<p>The above equations expand to a finite set of a few dozens of, in general,
non-linear algebraic contractions of <span class="math notranslate nohighlight">\(t^a_i\)</span> and <span class="math notranslate nohighlight">\(t^{ab}_{ij}\)</span> with
<span class="math notranslate nohighlight">\(\varepsilon_p\)</span> and <span class="math notranslate nohighlight">\(V^{pq}_{sr}\)</span>. See (Shavitt, Isaiah and Bartlett, Rodney J, 2009) for
a text-book introduction of the original works of
(Coester, F. and Kümmel, H., 1960) and (Čížek, Jirí, 1969).</p>
</section>
<section id="direct-ring-couple-cluster-doubles-drccd">
<h3><a class="toc-backref" href="#id33" role="doc-backlink">7.2 Direct-Ring Couple-Cluster Doubles (<code class="docutils literal notranslate"><span class="pre">Drccd</span></code>)</a><a class="headerlink" href="#direct-ring-couple-cluster-doubles-drccd" title="Link to this heading">¶</a></h3>
<p>This method uses only the double
excitation part of the cluster-operator. From
the full doubles amplitude equations in Eq. (ref{eqn:t2}) only
those contractions are considered where pairs of particle and hole
contractions originate from a common vertex and terminate in another
common vertex,
forming direct-rings in the diagrammatic notation.
Only five terms remain in a canonical calculation and they read</p>
<div class="math notranslate nohighlight" id="equation-algorithms-coupledcluster-3">
<span class="eqno">(4)<a class="headerlink" href="#equation-algorithms-coupledcluster-3" title="Link to this equation">¶</a></span>\[\begin{equation}
  \Delta^{ab}_{ij} t^{ab}_{ij}
  + V^{ab}_{ij}
  + V^{kb}_{cj} t^{ac}_{ik}
  + V^{al}_{id} t^{db}_{lj}
  + V^{kl}_{cd} t^{ac}_{ik} t^{db}_{lj} = 0 \quad \forall abij,
\end{equation}\]</div>
<p>with
<span class="math notranslate nohighlight">\(\Delta^{ab}_{ij} = \varepsilon_a+\varepsilon_b-\varepsilon_i-\varepsilon_j\)</span>
and where a sum over all indices that occurr only on the left-hand-side
is implied. These terms are the dominant terms of coupled-cluster singles
doubles in the hight-density limit (Gell-Mann, Murray and Brueckner, Keith A., 1957).
The direct correlation contribution of the <code class="docutils literal notranslate"><span class="pre">Drccd</span></code> method
<span class="math notranslate nohighlight">\(\sum_{abij} 2t^{ab}_{ij}V^{ij}_{ab}\)</span> gives the Random Phase Approximation (RPA),
the remaining exchange contribution is often termed Second Order
Screened Exchange (SOSEX) correction
(Freeman, David, 1977, Grüneis, Andreas and Marsman, Martijn and Harl, Judith and Schimka, Laurids and Kresse, Georg, 2009).
See ( Furche, Filipp ,  2008 ,  Chen, Guo P. and Agee, Matthew M. and Furche, Filipp ,  2018 ) for a review on the RPA and its corrections,
as well as (Macke, W., 1950, Pines, David and Bohm, David, 1952) for the
original work on the RPA.</p>
<p>We recommend the following review article and references therein to get started with coupled-cluster theory (Bartlett, R.J. and Musiał, Monika, 2007).</p>
</section>
</section>
<section id="literature">
<h2><a class="toc-backref" href="#id34" role="doc-backlink">8 Literature</a><a class="headerlink" href="#literature" title="Link to this heading">¶</a></h2>
<p>Chen, Guo P. and Agee, Matthew M. and Furche, Filipp  ( 2018 ). * Performance and Scope of Perturbative Corrections to Random-Phase Approximation Energies <a href="#id9"><span class="problematic" id="id10">*</span></a>,  J. Chem. Theory Comput. .</p>
<p>Furche, Filipp  ( 2008 ). * Developing the random phase approximation into a practical post-Kohn\textendash{}Sham correlation model <a href="#id11"><span class="problematic" id="id12">*</span></a>,  J. Chem. Phys. .</p>
<p>Bartlett, R.J. and Musiał, Monika (2007). <em>{Coupled-cluster theory in quantum chemistry}</em>, Rev. Mod. Phys..</p>
<p>Coester, F. and Kümmel, H. (1960). <em>Short-range correlations in nuclear wave functions</em>, Nucl. Phys..</p>
<p>Freeman, David (1977). <em>Coupled-cluster expansion applied to the electron gas: {Inclusion} of ring and exchange effects</em>, Physical Review B.</p>
<p>Gell-Mann, Murray and Brueckner, Keith A. (1957). <em>Correlation {Energy} of an {Electron} {Gas} at {High} {Density}</em>, Phys. Rev..</p>
<p>Grüneis, Andreas and Marsman, Martijn and Harl, Judith and Schimka, Laurids and Kresse, Georg (2009). <em>Making the random phase approximation to electronic correlation accurate</em>, J. Chem. Phys..</p>
<p>Macke, W. (1950). <em>Über die {Wechselwirkungen} im {Fermi}-{Gas}, {Polarisationserscheinungen}, {Correlationsenergie}, {Elektronenkondensation}</em>, Z. Naturforsch..</p>
<p>Pines, David and Bohm, David (1952). <em>A {Collective} {Description} of {Electron} {Interactions}: {II}. {Collective} vs {Individual} {Particle} {Aspects} of the {Interactions}</em>, Phys. Rev..</p>
<p>Shavitt, Isaiah and Bartlett, Rodney J (2009). <em>Many-body methods in chemistry and physics: {MBPT} and coupled-cluster theory</em>, Cambridge University Press.</p>
<p>Čížek, Jirí (1969). <em>On the {Use} of the {Cluster} {Expansion} and the {Technique} of {Diagrams} in {Calculations} of {Correlation} {Effects} in {Atoms} and {Molecules}</em>, John Wiley \&amp; Sons, Inc..</p>
</section>
</section>


          </div>
          <div class="page-nav">
            <div class="inner"><ul class="page-nav">
  <li class="prev">
    <a href="BasisSetCorrection.html"
       title="previous chapter">← BasisSetCorrection</a>
  </li>
  <li class="next">
    <a href="DefineHolesAndParticles.html"
       title="next chapter">DefineHolesAndParticles →</a>
  </li>
</ul><div class="footer" role="contentinfo">
      &#169; Copyright 1980, CC4S Developers.
    <br>
    Created using <a href="http://sphinx-doc.org/">Sphinx</a> 7.2.6 with <a href="https://github.com/schettino72/sphinx_press_theme">Press Theme</a> 0.8.0.
</div>
            </div>
          </div>
      </page>
    </div></div>
    
    
  </body>
</html>