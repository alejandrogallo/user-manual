#+title: =PerturbativeTriples= algorithm
#+options: toc:t

#+name: input-example
#+caption: Example input for Perturbative
#+begin_src yaml
- name: PerturbativeTriples
  in:
    coulombIntegrals: CoulombIntegrals
    amplitudes: Amplitudes
    slicedEigenEnergies: EigenEnergies
    mp2PairEnergies: Mp2PairEnergies
  out:
    energy:
      triples: triplesEnergy
      triples*: triplesEnergyStar
#+end_src


* Input Description

#+caption: Input keywords for PerturbativeTriples
| Input Keyword         | Description                    | Default |
|-----------------------+--------------------------------+---------|
| =amplitudes=          | [[../common-inputs.org::#amplitudes][Singles and doubles amplitudes]] |         |
| =coulombIntegrals=    | [[../common-inputs.org::#coulombintegrals][Coulomb Integrals]]              |         |
| =slicedEigenEnergies= | [[../common-inputs.org::#slicedeigenenergies][Sliced one-electron energies]]   |         |
| =mp2PairEnergies=     | [[#mp2pairenergies][MP2 pair energies matrix]]       |         |


** mp2PairEnergies
:PROPERTIES:
:CUSTOM_ID: mp2pairenergies
:END:

The =mp2PairEnergies= matrix is a matrix \( M_{ij} \)
of dimensions \( N_{\rm o} \times N_{\rm o}  \) such that
an MP2 energy is given by its full contraction, i.e.
\begin{equation}
\epsilon^{\mathrm{MP2}} = \sum_{ij} M_{ij}.
\end{equation}
This matrix is used in the context of the theory
CCSD(T*) [[cite:&FocalPointAppIrmler2021]],
where \( M_{ij} \) represents the Complete Basis Set (CBS) approximation to the MP2 pair energies.
When the =mp2PairEnergies= matrix is given as an input, the algorithm also computes the MP2 energy
from the Hartree-Fock eigenenergies \( \epsilon_p \) and the coulomb integrals
\( V^{ab}_{ij} \) within =slicedEigenEnergies= and =coulombIntegrals= respectively.
Using \( \epsilon^{\rm MP2}_{\rm CBS} \) calculated from \( M_{ij} \),
\( \epsilon^{\rm MP2} \) from \( \epsilon_p,  V^{ab}_{ij} \)
and computed CCSD(T) energy, the approximation
the CCSD(T*) is computed.






* Reference implementation

In addition to the =PerturbativeTriples= algorithm, there is also a slower
but reference implementation called =PerturbativeTriplesReference= which
is used in the same way as =PerturbativeTriples=.
To use it, you should just change the name =PerturbativeTriples= by =PerturbativeTriplesReference=.


* Literature
bibliography:../../group.bib
